---
title: "Fly High Project - Final Report"
output: 
  html_document:
    toc: true
    toc_float: true 
editor_options: 
  chunk_output_type: console
---


# Title

Data Analysis of Aviation Crashes 

# Group Members

  * Maya Arnott  
  * Karolina Wiesiolek  
  * Casandra Laney  
  * Zichen Fan 


# Motivation 
In recent years, airplane crashes seem to receive intense media attention, often framed as sensational “click-bait” headlines. This can create the impression that commercial air travel is increasingly dangerous, even though aviation is widely regarded as one of the safest modes of transportation.

Our project is motivated by two main goals:

1. Put aviation risk into context over time:

  + We want to examine how the frequency and severity of airplane crashes have changed across decades. Are crashes actually becoming more or less common? Have fatality rates per crash changed with improvements in technology and safety regulations?
  
2. Understand patterns across aircraft, operators, and seasons:

  + We are interested in which aircraft types, operators, and seasons are associated with more frequent or more severe crashes. We also plan to explore whether climate or seasonal patterns might be related to the timing or characteristics of crashes.
  + By combining historical crash records with external data (e.g., climate data), we hope to create a clearer, data-driven picture of aviation safety trends that goes beyond anecdotal media coverage.

# Related work
Several sources inspired this project:

  + News coverage of recent crashes, which often emphasizes rare catastrophic events without context, raising questions about perceived vs actual risk.
  + Course materials on data visualization and reproducible analysis, which emphasized using public datasets to answer real-world questions with transparent code and clear graphics.
  
We are building on this existing landscape by focusing specifically on:

  + Long-term temporal trends in crash frequency,
  + Operator and aircraft-type differences.
  

# Initial questions

Core Questions

As we started the project, our main questions were:

1. Temporal trends

    * How has the number of aviation crashes changed over time (e.g., by decade or year)?
    * How has the severity of crashes (e.g., number of fatalities per crash) changed over time?
    
2. Aircraft and operators

    * Which aircraft types/models are most frequently involved in crashes?
    * Which operators/airlines experience the highest number of crashes?
    * Are some operators associated with more severe outcomes (e.g., higher fatality counts per crash)?
    
3. Seasonality and environment

    * Are crashes more common in certain seasons or months of the year?
    * Are crashes more *statistically* significantly different in certain seasons?


As data exploration continued over the following weeks, additional questions were developed:

  * What is the best way to present the fatalities that occurred around the world? 
  * Are there notable geographic clusters of crashes? 
  * If certain aircraft or operators have very few crashes, we may shift toward grouping them into broader categories (e.g., commercial vs military, or regional vs major carriers).
  * What would a linear regression model for aircraft crashes look like? 

# Data Summary 

### Data Source:
The dataset was sourced as a CSV file from [Kaggle](https://www.kaggle.com) and stored in the datasets folder within our project directory. We read this dataset into R using `read_csv()` and maintained all code in an R Project linked to a public GitHub repository for reproducibility. An additional dataset was created by our group, which contains geocoded latitude and longitude information for each crash location. Because the Kaggle file lists location as text (e.g., “Paris, France” or “5 miles from Cairo”), our group geocoded each unique location string and stored the results in `geocoded_cache.csv`. This allowed us to build interactive maps to see the spatial distribution of crashes worldwide.

# Data and Exploratory Analysis

### Data Cleaning and Preparation
Before performing geographic or temporal analysis, our dataset required substantial cleaning due to inconsistent formatting and missing coordinate data. We wrote the preprocessing code used throughout the analysis pipeline. It included four major steps:  

1. The dataset was initially loaded as a tibble to be able to process, clean, and analyze it. Rows from `aboard` and `ground` with missing or placeholder values were  were removed to ensure cleaner data for analysis. `flight-number`, `time`, and `registration` columns were dropped because these did not contain relevant information for our analysis.

```{r}
airplane_df = read_csv("datasets/airplane_crashes_data.csv", show_col_types = FALSE) |> 
  janitor::clean_names() |> 
  filter(ground != "NULL", aboard != "NULL") |> 

  # removes unnecessary columns for our analyses
  select(-flight_number, -time, - registration)
```

2. The `date` column was initially stored as a string, so we first parsed it manually into numeric month/day/year. Then, the 2 digit years were able to be converted to 4 digit years to avoid misinterpreting. Columns for the numeric `year` `month`, and `month name` were created  for easier grouping, plotting, and analysis. 

```{r}
airplane_df = airplane_df |> 
  mutate(
    # remove leading and trailing spaces
    date = str_trim(date),
    
    # extract month, day, and year from the date string
    m = as.numeric(sub("/.*", "", date)),                    
    d = as.numeric(sub(".*/(.*)/.*", "\\1", date)),          
    y = as.numeric(sub(".*/(.*)$", "\\1", date)),            
    
    # convert 2-digit years (<100) to 4-digit (1900s)
    y = ifelse(y < 100, y + 1900, y),
    
    # rebuild the string
    date_clean = paste(m, d, y, sep = "/"),
    
    # convert to Date type
    date = mdy(date_clean),
    
    # extract numeric year and month
    year = year(date),
    month = month(date),
    month_name = factor(month(date, 
                              label = TRUE, 
                              abbr = TRUE), 
                              levels = month.abb)
  ) |>
  select(-m, -d, -y, -date_clean)  # remove unnecessary columns
```

3. Key columns were converted to numeric and operator was converted to a factor, so that we could group by operator in our analyses.

```{r}
airplane_df = airplane_df |> 
  mutate(
    aboard     = as.numeric(aboard),
    fatalities =  as.numeric(fatalities),
    ground     = as.numeric(ground),
    operator   = as.factor(operator)  # to group by operator
    )

```

4. Lastly, a `decade` column was created so that plots could be grouped by decade. 

```{r}
airplane_df = airplane_df |> 
  mutate(
    decade = floor(year / 10) * 10, 
    decade = paste0(decade, "s")
  ) |> 
  select(date, year, decade, month, month_name, everything()) 
```

### Analysis:

# Interactive Map 
1. Initial Cleaning of the Raw Dataset
- "NULL" entries in numeric columns (aboard, ground)
- Unnecessary textual variables (flight_number, time, registration)

```{r, eval=FALSE}
airplane_df = read_csv("datasets/airplane_crashes_data.csv") |>
  clean_names() |>
  filter(ground != "NULL", aboard != "NULL") |>
  select(-flight_number, -time, -registration)
```

This ensured that subsequent numerical processing would not break.

2. Parsing and Standardizing Dates

The original “date” column had inconsistent formatting (e.g., 3/4/78, 12/9/2001, 1/3/35). 
To prepare the variable for filtering and mapping, we:

- extracted the crash month using regex  
- extracted the crash day using regex  
- extracted the crash year using regex  
- converted 2-digit years into 4-digit format  
- reconstructed a consistent date string  
- converted the string into a real `Date` object  
- extracted the year for filtering and mapping  


```{r, eval=FALSE}
airplane_df = airplane_df |>
  mutate(
    date = str_trim(date),
    m = as.numeric(sub("/.*", "", date)),
    d = as.numeric(sub(".*/(.*)/.*", "\\1", date)),
    y = as.numeric(sub(".*/(.*)$", "\\1", date)),
    y = ifelse(y < 100, y + 1900, y),
    date_clean = paste(m, d, y, sep = "/"),
    date = mdy(date_clean),
    year = year(date)
  ) |>
  select(-m, -d, -y, -date_clean)
```

This step was essential because our interactive filters depend on having an accurate year variable and leaflet maps require a clean timeline for sorting or grouping crashes

3. Converting numeric variables:
Some numeric columns were stored as text and needed conversion:

```{r, eval=FALSE}
airplane_df = airplane_df |>
  mutate(
    aboard     = as.numeric(aboard),
    fatalities = as.numeric(fatalities),
    ground     = as.numeric(ground),
    operator   = as.factor(operator)
  )
```

Cleaning these variables allowed us to:
- filter crashes by fatality count
- color-code operators in maps

4. Joining Geocoded Coordinates for Mapping
Because the raw dataset contained only text descriptions of crash locations, our group generated a supplementary file (geocoded_cache.csv) containing:
- cleaned location names
- latitude and longitude for each crash
We merged this data with our cleaned dataset, this action produced the final dataset used in all mapping visuals: 

```{r, eval=FALSE}
df_map <- airplane_df |>
  left_join(geocoded_locations,
            by = c("location" = "location_clean")) |>
  filter(!is.na(Latitude), !is.na(Longitude))
```

5. Preparing the Shared Dataset for Interactive Filtering
To allow dynamic filtering without Shiny, I used the crosstalk package. This connects:
- the map
- the data table
- the filter widgets

All components update simultaneously without reloading.

```{r, eval=FALSE}
shared = SharedData$new(df_display, group = "crashes")
```

This enabled an interactive interface where users can:
- choose an operator
- filter by year
- select a fatality threshold
- see both the map and table update instantly

### Additional analysis 
(If you undertake formal statistical analyses, describe these in detail)

# Discussion
In this final stage of the project, we returned to the questions from our Motivation and Initial Questions sections to reflect on what we learned. 

The data and knowledge of the world demonstrates that as the total number of flights and passengers has increased over the decades, the aviation industry has become significantly safer due to stringent standards, advanced technology, and well-trained professionals. The absolute number of crashes has not risen in proportion to the volume of air traffic, meaning that the rate of accidents has fallen to historically low levels. 

Though the number of sudden fatalities due to aircraft crash is high and therefore is always highly covered by media outlets, commuting by air is considered one of the safest ways to commute. 


